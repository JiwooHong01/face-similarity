## Setup

Before installing DeepFace, ensure you have Python 3.5.5 or higher installed. If you want to utilize GPU acceleration, you'll need to install TensorFlow with CUDA support prior to installing DeepFace.

### GPU Installation (Optional)

To enable GPU support, install TensorFlow with CUDA by running:

```bash
pip install tensorflow[and-cuda]
```

### Installation Steps 
To install deepface, follow these steps:

1. Clone the repository:
```bash
git clone https://github.com/JungKH33/face-similarity.git
```

2. Navigate to the cloned directory:
```bash
cd deepface
```
3. Install deepface:
```bash
pip install -e .
```

### Download pretrained models
To use AdaFace, download the ONNX file from [this link](https://example.com/adaface_model.onnx) and place it in the `weights/adaface` folder.
You can change the directory if you modify the model_path variable in `deepface/basemodels/AdaFace`.

### Download Datasets 

The dataset we have provided can be downloaded from [this link](https://example.com/dataset.zip).

If you want to add a custom dataset, the dataset should be in the following structure:

```
ðŸ“¦ dataset_folder
â”œâ”€Â person_1
â”‚Â Â â”œâ”€Â image1.jpg
â”‚Â Â â”œâ”€Â image2.jpg
â”‚Â Â â””â”€Â ...
â”œâ”€Â person_2
â”‚Â Â â”œâ”€Â image1.jpg
â”‚Â Â â”œâ”€Â image2.jpg
â”‚Â Â â””â”€Â ...
â””â”€Â person_3
Â Â Â â”œâ”€Â image1.jpg
Â Â Â â”œâ”€Â image2.jpg
Â Â Â â””â”€Â ...
```

## Usage 

### Calculate Similarity

This script calculates the average similarity between multiple people. If a save path is not specified, it plots the similarity matrix; otherwise, it saves the similarity matrix to the specified path. 
You can run the script with the following command:

```bash
python similarity.py --dataset_path /path/to/dataset --save_path /path/to/save --model Facenet512 --backend retinaface
```

You can see the available models and backends by running:
```bash
python similarity.py --help
```

![Similarity Matrix](images/similarity_matrix.png)

*Figure 1: Example similarity matrix generated by the script. Each cell represents the similarity score between two individuals. Red colors indicate higher similarity, while blue colors indicate lower similarity.*
### Calculate Accuracy

This script calculates the accuracy of a model. You can test different models, backends and thresholds which fits your dataset best.

